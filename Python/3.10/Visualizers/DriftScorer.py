Recurring_HP_1_5 = [
    ["REFERENCE",   [20000, 45000, 70000]],
    ["LASSO",       [20000, 45000, 70000]],
    ["LAPS",        [5000, 15000, 30000, 40000, 55000, 70000, 85000]],
    ["CUMSUM",      [20273, 45264, 61045, 70302]],
    ["P-H",         [20851, 45265, 70630]],
    ["DDM",         [505, 5549, 20867, 28254, 48333, 73039]],
    ["EDDM",        [310, 5549, 10994, 16216, 21532, 26832, 32017, 37183, 42374, 47508, 52756, 58001, 63209, 68402, 73583, 78773, 84016, 89210, 94464]],
    ["HDDM-A",      [20046, 45685, 70158]],
    ["HDDM-W",      [20047, 45009, 70169]],
    ["RDDM",        [394, 5548, 12323, 17500, 23339, 30522, 37760, 45086, 50299, 59323, 66140, 71375, 76751, 82555, 88012]],
    ["ADWin",       [21471, 45830, 70509]],
    ["KSWin",       []],
    ["StepD",       [2891, 8771, 14772, 20014, 25428, 32318, 43299, 48425, 53694, 59278, 64728, 70001, 86530, 92575]],
]

Recurring_HP_1_20 = [
    ["REFERENCE",   [20000, 45000, 70000]],
    ["LASSO",       [25000]],
    ["LAPS",        [5000, 15000, 30000, 40000, 55000, 70000, 85000]],
    ["CUMSUM",      [20518, 37841, 45495, 70434]],
    ["P-H",         [21890, 45391, 71251]],
    ["DDM",         []],
    ["EDDM",        [108, 5232, 13742, 19021, 24098, 29200, 34310, 39405, 44533, 50500, 55609, 60706, 65826, 70901]],
    ["HDDM-A",      [1756, 7705, 14755, 78302]],
    ["HDDM-W",      [4814, 12391, 20206, 27856, 34899, 45011, 50462, 61752, 70156, 78262, 88383]],
    ["RDDM",        [20845, 26280, 33192, 38386, 45017, 50311, 58248, 64659, 70224]],
    ["ADWin",       [22527, 46982, 74541]],
    ["KSWin",       []],
    ["StepD",       [4816, 12280, 18409, 24086, 29245, 35497, 44878, 50464, 56088, 62259, 67377, 73614, 79679, 85408]],
]

Recurring_HP_20_15 = [
    ["REFERENCE",   [20000, 45000, 70000]],
    ["LASSO",       [20000, 45000, 70000]],
    ["LAPS",        [5000, 15000, 75000]],
    ["CUMSUM",      [20306, 45409, 70380]],
    ["P-H",         [20965, 46291, 70801]],
    ["DDM",         [40, 24157, 49331, 55204]],
    ["EDDM",        [150, 5275, 10382, 15544, 20704, 25845, 30944, 36078, 41323, 46427, 51539, 56685, 61792, 66922, 72023, 77144, 82269, 87411, 92498]],
    ["HDDM-A",      [2832, 8754, 20242, 45588, 70538, 80145]],
    ["HDDM-W",      [6278, 13118, 20240, 29788, 41794, 49285, 68587, 74738, 81767, 87806, 93810]],
    ["RDDM",        [322, 6613, 11815, 20213, 45619, 51132, 70304, 76506, 81835, 87116, 92371]],
    ["ADWin",       [22399, 46342, 71757]],
    ["KSWin",       []],
    ["StepD",       [334, 6099, 11203, 18488, 24751, 29863, 36089, 41480, 46761, 52158, 58226, 64625, 70016, 75910, 81770, 87816, 92889]],
]

Recurring_HP_20_5 = [
    ["REFERENCE",   [20000, 45000, 70000]],
    ["LASSO",       [20000, 45000, 70000]],
    ["LAPS",        [5000, 15000, 75000]],
    ["CUMSUM",      [20737, 45497, 69535]],
    ["P-H",         [21674, 46574, 70951]],
    ["DDM",         []],
    ["EDDM",        [108, 5232, 13742, 19021, 24155, 29255, 34345, 39430, 44581, 49862, 55080, 60217, 65381, 70464, 75661, 80760, 85863, 90957]],
    ["HDDM-A",      [2738, 20417, 37751, 45457, 60249, 70760]],
    ["HDDM-W",      [4817, 10348, 20514, 28706, 40543, 47481, 57475, 65236, 74068, 80247, 87068, 94451]],
    ["RDDM",        [20990, 46292, 53740, 60011, 66685, 72992, 83078]],
    ["ADWin",       [22527, 46918, 74445]],
    ["KSWin",       []],
    ["StepD",       [4816, 12280, 18409, 23567, 29344, 35197, 41500, 46913, 53977, 59279, 65236, 76931, 83478, 89542]],
]

Recurring_HP_20_20 = [
    ["REFERENCE",   [20000, 45000, 70000]],
    ["LASSO",       [20000, 45000, 70000]],
    ["LAPS",        [5000, 15000, 75000]],
    ["CUMSUM",      [20737, 45497, 69535]],
    ["P-H",         [21674, 46574, 70951]],
    ["DDM",         []],
    ["EDDM",        [108, 5232, 13742, 19021, 24155, 29255, 34345, 39430, 44581, 49862, 55080, 60217, 65381, 70464, 75661, 80760, 85863, 90957]],
    ["HDDM-A",      [2738, 20417, 37751, 45457, 60249, 70760]],
    ["HDDM-W",      [4817, 10348, 20514, 28706, 40543, 47481, 57475, 65236, 74068, 80247, 87068, 94451]],
    ["RDDM",        [20990, 46292, 53740, 60011, 66685, 72992, 83078]],
    ["ADWin",       [22527, 46918, 74445]],
    ["KSWin",       []],
    ["StepD",       [4816, 12280, 18409, 23567, 29344, 35197, 41500, 46913, 53977, 59279, 65236, 76931, 83478, 89542]],
]

Incremental_HP_1_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       []],
    ["LAPS",        [5000, 15000, 30000, 40000, 65000]],
    ["CUMSUM",      [3001, 9477, 36139, 42407, 51433, 59617, 66789, 77252, 87526]],
    ["P-H",         [3113, 9971, 36315, 42277, 51284, 59857, 66872, 92381]],
    ["DDM",         [51, 23506, 28626, 34865, 41493, 51216, 59603, 66533, 71579, 91142]],
    ["EDDM",        [216, 13640, 18786, 24025, 29398, 34627, 39767, 45030, 51339, 56491, 61627, 66744, 72103, 77296, 82482, 87819, 93658]],
    ["HDDM-A",      [3067, 9593, 36176, 42581, 52366, 66176, 72623, 91499]],
    ["HDDM-W",      [3085, 11294, 36114, 42071, 50085, 61831, 69339, 93602]],
    ["RDDM",        [2458, 8985, 15377, 20673, 27262, 32632, 53936, 59165, 65687, 71554, 88228]],
    ["ADWin",       [3359, 10662, 36557, 43700, 52283, 63426]],
    ["KSWin",       []],
    ["StepD",       [75, 6614, 12013, 18317, 23877, 29204, 34846, 40868, 46913, 52331, 57762, 66188, 71485, 81116, 87833]],
]

Incremental_HP_1_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       []],
    ["LAPS",        [5000, 15000, 30000, 40000, 65000]],
    ["CUMSUM",      [3633, 11946, 35544, 42088, 52811, 66238, 91899]],
    ["P-H",         [3872, 12715, 23258, 35813, 42538, 53526, 67416, 93313]],
    ["DDM",         []],
    ["EDDM",        [104, 5518, 10658, 15762, 20904, 26045, 31197, 36267, 41367, 46493, 52982, 60357, 65456, 70592, 75687, 81075, 86195, 91301]],
    ["HDDM-A",      [1779, 12046, 36119, 43636, 53317, 66299, 81119, 91969]],
    ["HDDM-W",      [3445, 11327, 22362, 32644, 38327, 45149, 52665, 59618, 66758, 74932, 81126, 87835]],
    ["RDDM",        [3405, 8946, 15142, 33491, 48845, 61960, 67275, 72632, 77910, 84203, 89574]],
    ["ADWin",       [4767, 14374, 36781, 53972, 69211, 94690]],
    ["KSWin",       []],
    ["StepD",       [3186, 8850, 14657, 20178, 26705, 35554, 41654, 49007, 54179, 60003, 67635, 75768, 81118, 86421, 93722]],
]

Incremental_HP_20_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [15000, 40000, 80000]],
    ["LAPS",        [40000, 55000, 90000]],
    ["CUMSUM",      [4026, 15931, 24096, 31703, 44032, 53333, 63625, 82175, 94441]],
    ["P-H",         [4640, 18848, 32887, 44181, 57269, 68186, 86213]],
    ["DDM",         [5139, 15866, 21326, 32043, 44593, 50728, 62264, 84318]],
    ["EDDM",        [104, 5228, 10377, 15523, 20735, 25952, 31207, 36417, 41606, 46801, 52993, 58196, 67020, 72351, 77622, 82864, 87996, 93196]],
    ["HDDM-A",      [4608, 21221, 34151, 44672, 61020, 88311]],
    ["HDDM-W",      [2512, 8663, 16495, 34209, 49705, 59911, 70499, 93644]],
    ["RDDM",        [422, 7496, 12724, 17870, 23206, 28406, 45108, 54384, 66715, 74390, 79684, 85363, 91399]],
    ["ADWin",       [7167, 20134, 34093, 48308, 60699, 90274]],
    ["KSWin",       []],
    ["StepD",       [731, 6505, 12184, 19541, 25656, 34049, 43727, 50636, 57797, 65087, 71511, 78511, 85306, 91634]],
]

Incremental_HP_20_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [15000, 40000, 50000, 80000]],
    ["LAPS",        [40000, 55000, 90000]],
    ["CUMSUM",      [5269, 20289, 31765, 45920, 60417, 68558, 86060]],
    ["P-H",         [6588, 22006, 34102, 48186, 61200, 74810]],
    ["DDM",         [6410, 23172, 34356, 91998]],
    ["EDDM",        [477, 5571, 10930, 16121, 21235, 26454, 31550, 36647, 41767, 46908, 52005, 57098, 62224, 67323, 72592, 77997, 83580, 88671, 93799]],
    ["HDDM-A",      [153, 20543, 34467, 49647, 64743, 77128, 84908]],
    ["HDDM-W",      [2454, 9147, 20141, 29818, 40381, 48952, 56910, 65290, 72945, 80944, 87346, 93249]],
    ["RDDM",        [5143, 10583, 15948, 21357, 32130, 42013, 48578, 53987, 59187, 64495, 74643, 80025, 85311, 92128]],
    ["ADWin",       [16479, 50150, 69485, 77268]],
    ["KSWin",       []],
    ["StepD",       [4002, 10582, 15948, 21537, 31445, 38341, 44541, 50423, 57766, 62907, 68549, 74097, 79181, 84257, 89421]],
]

Gradual_HP_1_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [60000]],
    ["LAPS",        [5000, 15000, 25000, 40000, 65000, 80000]],
    ["CUMSUM",      [36516, 47503]],
    ["P-H",         [38879, 63389]],
    ["DDM",         [53893]],
    ["EDDM",        [247, 5644, 11349, 16620, 21856, 27059, 32262, 37463, 42612, 47789, 52994, 58192, 63394, 68621, 73822, 78999, 84277, 89649, 94912]],
    ["HDDM-A",      [40399]],
    ["HDDM-W",      [44487, 69596, 86660]],
    ["RDDM",        [311, 36774, 44393, 50161, 55539]],
    ["ADWin",       [40959]],
    ["KSWin",       []],
    ["StepD",       [325, 6623, 12214, 18531, 23993, 33173, 38609, 45129, 51345, 57112, 63392, 71743, 77107, 84362]],
]

Gradual_HP_1_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [60000]],
    ["LAPS",        [5000, 15000, 25000, 40000, 65000, 80000]],
    ["CUMSUM",      [34501, 42594, 56249]],
    ["P-H",         [37213, 48392, 57750]],
    ["DDM",         [49701]],
    ["EDDM",        [247, 5644, 11372, 16619, 21859, 27049, 32281, 37422, 42589, 47763]],
    ["HDDM-A",      [42050, 60358]],
    ["HDDM-W",      [40736, 47767, 55459, 63307, 68871, 75284, 81846, 90317]],
    ["RDDM",        [311, 34594, 40857, 46353, 52033, 68548, 74611, 80009, 88394, 94081]],
    ["ADWin",       [40607, 61190]],
    ["KSWin",       []],
    ["StepD",       [325, 6623, 12215, 17525, 23278, 28897, 34847, 40715, 45805, 51124, 57568, 64505, 70583, 76040, 81637, 88531, 94766]],
]

Gradual_HP_20_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [70000, 80000]],
    ["LAPS",        [5000, 15000, 20000, 45000, 55000, 70000, 85000]],
    ["CUMSUM",      [37360, 50113, 60627, 71213, 87475]],
    ["P-H",         [39178, 51070, 61700, 79007]],
    ["DDM",         [54074, 79078]],
    ["EDDM",        [247, 5445, 10669, 15995, 38925, 44798, 50107, 55317, 60641, 65963, 71133, 76378, 81627]],
    ["HDDM-A",      [48789, 66556, 92120]],
    ["HDDM-W",      [29938, 49583, 59130, 76484]],
    ["RDDM",        [311, 8623, 13936, 32682, 40201, 45439, 50793, 58404, 63591]],
    ["ADWin",       [40959, 55942, 75277]],
    ["KSWin",       []],
    ["StepD",       [325, 6627, 18823, 23998, 29307, 36671, 43874, 51130, 59349, 66369, 73567, 79601, 84711, 91849]],
]

Gradual_HP_20_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [70000]],
    ["LAPS",        [5000, 15000, 20000, 45000, 55000, 70000, 85000]],
    ["CUMSUM",      [31786, 41927, 51508, 64666]],
    ["P-H",         [37352, 47442, 60886, 80687]],
    ["DDM",         [50241]],
    ["EDDM",        [247, 5445, 10672, 15880, 21072, 26709, 31925, 37086, 42233, 47327, 52435, 57556, 62639, 67748, 72856, 77957, 83133, 88243, 93480]],
    ["HDDM-A",      [39696, 52058, 71510]],
    ["HDDM-W",      [29938, 44308, 51138, 61142, 68123, 74689, 80621, 88899, 94342]],
    ["RDDM",        [311, 8607, 13908, 19119, 24799, 29939, 35456, 40716, 46184, 58256, 74865, 87465, 93226]],
    ["ADWin",       [40575, 57862, 89261]],
    ["KSWin",       []],
    ["StepD",       [325, 6627, 18823, 23998, 29993, 35569, 41824, 48595, 53968, 60082, 67544, 74702, 80602, 88757]],
]

Abrupt_HP_1_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [45000]],
    ["LAPS",        [5000, 15000, 25000, 35000, 50000, 80000, 90000]],
    ["CUMSUM",      [45190, 66776, 87436]],
    ["P-H",         [45473]],
    ["DDM",         [505, 5549, 49493]],
    ["EDDM",        [310, 5549, 10994, 16216, 21437, 26593, 31818, 37896, 43245, 48394, 53588, 58851, 64035, 69245, 74635, 79849, 85047, 90385]],
    ["HDDM-A",      [45814]],
    ["HDDM-W",      [45048]],
    ["RDDM",        [394, 5548, 12323, 17500, 22751, 45273, 50427, 57598]],
    ["ADWin",       [45599]],
    ["KSWin",       []],
    ["StepD",       [2891, 8771, 14772, 20019, 29840, 38629, 45090, 50431, 57316, 63925, 68996, 74259, 79989, 89025]],
]

Abrupt_HP_1_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [45000]],
    ["LAPS",        [5000, 15000, 25000, 35000, 50000, 80000, 90000]],
    ["CUMSUM",      [45133, 62788]],
    ["P-H",         [45342]],
    ["DDM",         [505, 5549, 48076]],
    ["EDDM",        [310, 5549, 10994, 16216, 21437, 26593, 31818, 37896, 43245, 49120, 54252, 59395, 64521, 69631, 74884, 79971, 85073, 90161]],
    ["HDDM-A",      [45550]],
    ["HDDM-W",      [45042, 55128, 62714, 69881, 81548, 88602]],
    ["RDDM",        [394, 5548, 12323, 17500, 22751, 45203, 64206, 70175, 75451, 80711, 88700, 94068]],
    ["ADWin",       [45407]],
    ["KSWin",       []],
    ["StepD",       [2891, 8771, 14772, 20019, 29840, 38629, 45079, 52859, 58177, 63481, 71355, 77337, 82959, 88444]],
]

Abrupt_HP_20_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [70000]],
    ["LAPS",        [5000, 15000, 25000, 35000, 45000, 80000, 90000]],
    ["CUMSUM",      [45242, 57565, 68321, 77564, 92276]],
    ["P-H",         [45540, 57651, 68822, 91053]],
    ["DDM",         [505, 5549, 49332, 60218, 68944, 75425, 86123, 92005]],
    ["EDDM",        [310, 5549, 10994, 16216, 21437, 26593, 31818, 37896, 43245, 48412, 53630, 61565, 66801, 71954, 77152, 82480, 87750, 92928]],
    ["HDDM-A",      [45190, 61179, 80222]],
    ["HDDM-W",      [45190, 62723, 72550]],
    ["RDDM",        [394, 5548, 12323, 17500, 22751, 45352, 53559, 58929, 64108, 69544, 74756, 79923, 85359, 94408]],
    ["ADWin",       [45631, 64966]],
    ["KSWin",       []],
    ["StepD",       [2891, 8771, 14772, 20019, 29840, 38629, 45189, 52734, 58663, 66496, 71926, 77149, 85019, 91986]],
]

Abrupt_HP_20_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [45000]],
    ["LAPS",        [5000, 15000, 25000, 35000, 45000, 80000, 90000]],
    ["CUMSUM",      [45194, 57548, 71948, 87381]],
    ["P-H",         [45378, 57668, 71528, 91612]],
    ["DDM",         [505, 5549, 48011, 66597]],
    ["EDDM",        [310, 5549, 10994, 16216, 21437, 26593, 31818, 37896, 43245, 48324, 53437, 58657, 63756, 69309, 74420, 79541, 84908]],
    ["HDDM-A",      [45142, 56516, 80028]],
    ["HDDM-W",      [45190, 54199, 61566, 69002, 77136, 82969, 90678]],
    ["RDDM",        [394, 5548, 12323, 17500, 22751, 45252, 56508, 75492, 80691, 86188, 94725]],
    ["ADWin",       [45439, 67462]],
    ["KSWin",       []],
    ["StepD",       [2891, 8771, 14772, 20019, 29840, 38629, 45024, 50545, 56160, 61943, 68242, 77495, 84746, 90672]],
]

def split_detections(detectedIdx, trueIdx, epsilon):
    detectionTrue = []
    detectionFalse = []
    detectionMissed = []

    for detected in detectedIdx:
        if any(abs(detected - true) <= epsilon for true in trueIdx):
            detectionTrue.append(detected)
        else:
            detectionFalse.append(detected)

    for true in trueIdx:
        if not(any(abs(detected - true) <= epsilon for detected in detectedIdx)):
            detectionMissed.append(true)

    return detectionTrue, detectionFalse, detectionMissed

detectors = Recurring_HP_1_5
realDriftIdx = detectors[0][1]
epsilon = 2000

for det in range(1, len(detectors)):
    detectedTrueDriftIdx, detectedFalseDriftIdx, detectedMissedDriftIdx = split_detections(
        detectors[det][1], realDriftIdx, epsilon
    )
    TP = len(detectedTrueDriftIdx)
    FP = len(detectedFalseDriftIdx)
    FN = len(detectedMissedDriftIdx)
    print(detectors[det][0], "\t", TP, "\t", FP, "\t", FN)

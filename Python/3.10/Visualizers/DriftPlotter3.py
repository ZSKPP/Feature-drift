import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import rc

rc("pdf", fonttype=42)


def split_detections(detectedIdx, trueIdx, epsilon):
    detectionTrue = []
    detectionFalse = []

    for detected in detectedIdx:
        if any(abs(detected - true) <= epsilon for true in trueIdx):
            detectionTrue.append(detected)
        else:
            detectionFalse.append(detected)

    return detectionTrue, detectionFalse


horizLine = []

Recurring_HP_1_5 = [
    ["REFERENCE",   [20000, 45000, 70000]],
    ["LASSO",       [20000, 45000, 70000]],
    ["LAPScore",    [5000, 15000, 30000, 40000, 55000, 70000, 85000]],
    ["CUMSUM",      [20273, 45264, 61045, 70302]],
    ["Page-Hinkley",[20851, 45265, 70630]],
    ["DDM",         [505, 5549, 20867, 28254, 48333, 73039]],
    ["EDDM",        [310, 5549, 10994, 16216, 21532, 26832, 32017, 37183, 42374, 47508, 52756, 58001, 63209, 68402, 73583, 78773, 84016, 89210, 94464]],
    ["HDDM-A",      [20046, 45685, 70158]],
    ["HDDM-W",      [20047, 45009, 70169]],
    ["RDDM",        [394, 5548, 12323, 17500, 23339, 30522, 37760, 45086, 50299, 59323, 66140, 71375, 76751, 82555, 88012]],
    ["ADWin",       [21471, 45830, 70509]],
    ["KSWin",       []],
    ["StepD",       [2891, 8771, 14772, 20014, 25428, 32318, 43299, 48425, 53694, 59278, 64728, 70001, 86530, 92575]],
]

Recurring_HP_1_20 = [
    ["REFERENCE",   [20000, 45000, 70000]],
    ["LASSO",       [25000]],
    ["LAPScore",    [5000, 15000, 30000, 40000, 55000, 70000, 85000]],
    ["CUMSUM",      [20518, 37841, 45495, 70434]],
    ["Page-Hinkley",[21890, 45391, 71251]],
    ["DDM",         []],
    ["EDDM",        [108, 5232, 13742, 19021, 24098, 29200, 34310, 39405, 44533, 50500, 55609, 60706, 65826, 70901]],
    ["HDDM-A",      [1756, 7705, 14755, 78302]],
    ["HDDM-W",      [4814, 12391, 20206, 27856, 34899, 45011, 50462, 61752, 70156, 78262, 88383]],
    ["RDDM",        [20845, 26280, 33192, 38386, 45017, 50311, 58248, 64659, 70224]],
    ["ADWin",       [22527, 46982, 74541]],
    ["KSWin",       []],
    ["StepD",       [4816, 12280, 18409, 24086, 29245, 35497, 44878, 50464, 56088, 62259, 67377, 73614, 79679, 85408]],
]

Recurring_HP_20_15 = [
    ["REFERENCE",   [20000, 45000, 70000]],
    ["LASSO",       [20000, 45000, 70000]],
    ["LAPScore",    [5000, 15000, 75000]],
    ["CUMSUM",      [20306, 45409, 70380]],
    ["Page-Hinkley",[20965, 46291, 70801]],
    ["DDM",         [40, 24157, 49331, 55204]],
    ["EDDM",        [150, 5275, 10382, 15544, 20704, 25845, 30944, 36078, 41323, 46427, 51539, 56685, 61792, 66922, 72023, 77144, 82269, 87411, 92498]],
    ["HDDM-A",      [2832, 8754, 20242, 45588, 70538, 80145]],
    ["HDDM-W",      [6278, 13118, 20240, 29788, 41794, 49285, 68587, 74738, 81767, 87806, 93810]],
    ["RDDM",        [322, 6613, 11815, 20213, 45619, 51132, 70304, 76506, 81835, 87116, 92371]],
    ["ADWin",       [22399, 46342, 71757]],
    ["KSWin",       []],
    ["StepD",       [334, 6099, 11203, 18488, 24751, 29863, 36089, 41480, 46761, 52158, 58226, 64625, 70016, 75910, 81770, 87816, 92889]],
]

Recurring_HP_20_5 = [
    ["REFERENCE",   [20000, 45000, 70000]],
    ["LASSO",       [20000, 45000, 70000]],
    ["LAPScore",    [5000, 15000, 75000]],
    ["CUMSUM",      [20737, 45497, 69535]],
    ["Page-Hinkley",[21674, 46574, 70951]],
    ["DDM",         []],
    ["EDDM",        [108, 5232, 13742, 19021, 24155, 29255, 34345, 39430, 44581, 49862, 55080, 60217, 65381, 70464, 75661, 80760, 85863, 90957]],
    ["HDDM-A",      [2738, 20417, 37751, 45457, 60249, 70760]],
    ["HDDM-W",      [4817, 10348, 20514, 28706, 40543, 47481, 57475, 65236, 74068, 80247, 87068, 94451]],
    ["RDDM",        [20990, 46292, 53740, 60011, 66685, 72992, 83078]],
    ["ADWin",       [22527, 46918, 74445]],
    ["KSWin",       []],
    ["StepD",       [4816, 12280, 18409, 23567, 29344, 35197, 41500, 46913, 53977, 59279, 65236, 76931, 83478, 89542]],
]

Recurring_HP_20_20 = [
    ["REFERENCE",   [20000, 45000, 70000]],
    ["LASSO",       [20000, 45000, 70000]],
    ["LAPScore",    [5000, 15000, 75000]],
    ["CUMSUM",      [20737, 45497, 69535]],
    ["Page-Hinkley",[21674, 46574, 70951]],
    ["DDM",         []],
    ["EDDM",        [108, 5232, 13742, 19021, 24155, 29255, 34345, 39430, 44581, 49862, 55080, 60217, 65381, 70464, 75661, 80760, 85863, 90957]],
    ["HDDM-A",      [2738, 20417, 37751, 45457, 60249, 70760]],
    ["HDDM-W",      [4817, 10348, 20514, 28706, 40543, 47481, 57475, 65236, 74068, 80247, 87068, 94451]],
    ["RDDM",        [20990, 46292, 53740, 60011, 66685, 72992, 83078]],
    ["ADWin",       [22527, 46918, 74445]],
    ["KSWin",       []],
    ["StepD",       [4816, 12280, 18409, 23567, 29344, 35197, 41500, 46913, 53977, 59279, 65236, 76931, 83478, 89542]],
]

Incremental_HP_1_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       []],
    ["LAPScore",    [5000, 15000, 30000, 40000, 65000]],
    ["CUMSUM",      [3001, 9477, 36139, 42407, 51433, 59617, 66789, 77252, 87526]],
    ["Page-Hinkley",[3113, 9971, 36315, 42277, 51284, 59857, 66872, 92381]],
    ["DDM",         [51, 23506, 28626, 34865, 41493, 51216, 59603, 66533, 71579, 91142]],
    ["EDDM",        [216, 13640, 18786, 24025, 29398, 34627, 39767, 45030, 51339, 56491, 61627, 66744, 72103, 77296, 82482, 87819, 93658]],
    ["HDDM-A",      [3067, 9593, 36176, 42581, 52366, 66176, 72623, 91499]],
    ["HDDM-W",      [3085, 11294, 36114, 42071, 50085, 61831, 69339, 93602]],
    ["RDDM",        [2458, 8985, 15377, 20673, 27262, 32632, 53936, 59165, 65687, 71554, 88228]],
    ["ADWin",       [3359, 10662, 36557, 43700, 52283, 63426]],
    ["KSWin",       []],
    ["StepD",       [75, 6614, 12013, 18317, 23877, 29204, 34846, 40868, 46913, 52331, 57762, 66188, 71485, 81116, 87833]],
]

Incremental_HP_1_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       []],
    ["LAPScore",    [5000, 15000, 30000, 40000, 65000]],
    ["CUMSUM",      [3633, 11946, 35544, 42088, 52811, 66238, 91899]],
    ["Page-Hinkley",[3872, 12715, 23258, 35813, 42538, 53526, 67416, 93313]],
    ["DDM",         []],
    ["EDDM",        [104, 5518, 10658, 15762, 20904, 26045, 31197, 36267, 41367, 46493, 52982, 60357, 65456, 70592, 75687, 81075, 86195, 91301]],
    ["HDDM-A",      [1779, 12046, 36119, 43636, 53317, 66299, 81119, 91969]],
    ["HDDM-W",      [3445, 11327, 22362, 32644, 38327, 45149, 52665, 59618, 66758, 74932, 81126, 87835]],
    ["RDDM",        [3405, 8946, 15142, 33491, 48845, 61960, 67275, 72632, 77910, 84203, 89574]],
    ["ADWin",       [4767, 14374, 36781, 53972, 69211, 94690]],
    ["KSWin",       []],
    ["StepD",       [3186, 8850, 14657, 20178, 26705, 35554, 41654, 49007, 54179, 60003, 67635, 75768, 81118, 86421, 93722]],
]

Incremental_HP_20_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [15000, 40000, 80000]],
    ["LAPScore",    [40000, 55000, 90000]],
    ["CUMSUM",      [4026, 15931, 24096, 31703, 44032, 53333, 63625, 82175, 94441]],
    ["Page-Hinkley",[4640, 18848, 32887, 44181, 57269, 68186, 86213]],
    ["DDM",         [5139, 15866, 21326, 32043, 44593, 50728, 62264, 84318]],
    ["EDDM",        [104, 5228, 10377, 15523, 20735, 25952, 31207, 36417, 41606, 46801, 52993, 58196, 67020, 72351, 77622, 82864, 87996, 93196]],
    ["HDDM-A",      [4608, 21221, 34151, 44672, 61020, 88311]],
    ["HDDM-W",      [2512, 8663, 16495, 34209, 49705, 59911, 70499, 93644]],
    ["RDDM",        [422, 7496, 12724, 17870, 23206, 28406, 45108, 54384, 66715, 74390, 79684, 85363, 91399]],
    ["ADWin",       [7167, 20134, 34093, 48308, 60699, 90274]],
    ["KSWin",       []],
    ["StepD",       [731, 6505, 12184, 19541, 25656, 34049, 43727, 50636, 57797, 65087, 71511, 78511, 85306, 91634]],
]

Incremental_HP_20_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [15000, 40000, 50000, 80000]],
    ["LAPScore",    [40000, 55000, 90000]],
    ["CUMSUM",      [5269, 20289, 31765, 45920, 60417, 68558, 86060]],
    ["Page-Hinkley",[6588, 22006, 34102, 48186, 61200, 74810]],
    ["DDM",         [6410, 23172, 34356, 91998]],
    ["EDDM",        [477, 5571, 10930, 16121, 21235, 26454, 31550, 36647, 41767, 46908, 52005, 57098, 62224, 67323, 72592, 77997, 83580, 88671, 93799]],
    ["HDDM-A",      [153, 20543, 34467, 49647, 64743, 77128, 84908]],
    ["HDDM-W",      [2454, 9147, 20141, 29818, 40381, 48952, 56910, 65290, 72945, 80944, 87346, 93249]],
    ["RDDM",        [5143, 10583, 15948, 21357, 32130, 42013, 48578, 53987, 59187, 64495, 74643, 80025, 85311, 92128]],
    ["ADWin",       [16479, 50150, 69485, 77268]],
    ["KSWin",       []],
    ["StepD",       [4002, 10582, 15948, 21537, 31445, 38341, 44541, 50423, 57766, 62907, 68549, 74097, 79181, 84257, 89421]],
]

Gradual_HP_1_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [60000]],
    ["LAPScore",    [5000, 15000, 25000, 40000, 65000, 80000]],
    ["CUMSUM",      [36516, 47503]],
    ["Page-Hinkley",[38879, 63389]],
    ["DDM",         [53893]],
    ["EDDM",        [247, 5644, 11349, 16620, 21856, 27059, 32262, 37463, 42612, 47789, 52994, 58192, 63394, 68621, 73822, 78999, 84277, 89649, 94912]],
    ["HDDM-A",      [40399]],
    ["HDDM-W",      [44487, 69596, 86660]],
    ["RDDM",        [311, 36774, 44393, 50161, 55539]],
    ["ADWin",       [40959]],
    ["KSWin",       []],
    ["StepD",       [325, 6623, 12214, 18531, 23993, 33173, 38609, 45129, 51345, 57112, 63392, 71743, 77107, 84362]],
]

Gradual_HP_1_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [60000]],
    ["LAPScore",    [5000, 15000, 25000, 40000, 65000, 80000]],
    ["CUMSUM",      [34501, 42594, 56249]],
    ["Page-Hinkley",[37213, 48392, 57750]],
    ["DDM",         [49701]],
    ["EDDM",        [247, 5644, 11372, 16619, 21859, 27049, 32281, 37422, 42589, 47763]],
    ["HDDM-A",      [42050, 60358]],
    ["HDDM-W",      [40736, 47767, 55459, 63307, 68871, 75284, 81846, 90317]],
    ["RDDM",        [311, 34594, 40857, 46353, 52033, 68548, 74611, 80009, 88394, 94081]],
    ["ADWin",       [40607, 61190]],
    ["KSWin",       []],
    ["StepD",       [325, 6623, 12215, 17525, 23278, 28897, 34847, 40715, 45805, 51124, 57568, 64505, 70583, 76040, 81637, 88531, 94766]],
]

Gradual_HP_20_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [70000, 80000]],
    ["LAPScore",    [5000, 15000, 20000, 45000, 55000, 70000, 85000]],
    ["CUMSUM",      [37360, 50113, 60627, 71213, 87475]],
    ["Page-Hinkley",[39178, 51070, 61700, 79007]],
    ["DDM",         [54074, 79078]],
    ["EDDM",        [247, 5445, 10669, 15995, 38925, 44798, 50107, 55317, 60641, 65963, 71133, 76378, 81627]],
    ["HDDM-A",      [48789, 66556, 92120]],
    ["HDDM-W",      [29938, 49583, 59130, 76484]],
    ["RDDM",        [311, 8623, 13936, 32682, 40201, 45439, 50793, 58404, 63591]],
    ["ADWin",       [40959, 55942, 75277]],
    ["KSWin",       []],
    ["StepD",       [325, 6627, 18823, 23998, 29307, 36671, 43874, 51130, 59349, 66369, 73567, 79601, 84711, 91849]],
]

Gradual_HP_20_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [70000]],
    ["LAPScore",    [5000, 15000, 20000, 45000, 55000, 70000, 85000]],
    ["CUMSUM",      [31786, 41927, 51508, 64666]],
    ["Page-Hinkley",[37352, 47442, 60886, 80687]],
    ["DDM",         [50241]],
    ["EDDM",        [247, 5445, 10672, 15880, 21072, 26709, 31925, 37086, 42233, 47327, 52435, 57556, 62639, 67748, 72856, 77957, 83133, 88243, 93480]],
    ["HDDM-A",      [39696, 52058, 71510]],
    ["HDDM-W",      [29938, 44308, 51138, 61142, 68123, 74689, 80621, 88899, 94342]],
    ["RDDM",        [311, 8607, 13908, 19119, 24799, 29939, 35456, 40716, 46184, 58256, 74865, 87465, 93226]],
    ["ADWin",       [40575, 57862, 89261]],
    ["KSWin",       []],
    ["StepD",       [325, 6627, 18823, 23998, 29993, 35569, 41824, 48595, 53968, 60082, 67544, 74702, 80602, 88757]],
]

Abrupt_HP_1_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [45000]],
    ["LAPScore",    [5000, 15000, 25000, 35000, 50000, 80000, 90000]],
    ["CUMSUM",      [45190, 66776, 87436]],
    ["Page-Hinkley",[45473]],
    ["DDM",         [505, 5549, 49493]],
    ["EDDM",        [310, 5549, 10994, 16216, 21437, 26593, 31818, 37896, 43245, 48394, 53588, 58851, 64035, 69245, 74635, 79849, 85047, 90385]],
    ["HDDM-A",      [45814]],
    ["HDDM-W",      [45048]],
    ["RDDM",        [394, 5548, 12323, 17500, 22751, 45273, 50427, 57598]],
    ["ADWin",       [45599]],
    ["KSWin",       []],
    ["StepD",       [2891, 8771, 14772, 20019, 29840, 38629, 45090, 50431, 57316, 63925, 68996, 74259, 79989, 89025]],
]

Abrupt_HP_1_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [45000]],
    ["LAPScore",    [5000, 15000, 25000, 35000, 50000, 80000, 90000]],
    ["CUMSUM",      [45133, 62788]],
    ["Page-Hinkley",[45342]],
    ["DDM",         [505, 5549, 48076]],
    ["EDDM",        [310, 5549, 10994, 16216, 21437, 26593, 31818, 37896, 43245, 49120, 54252, 59395, 64521, 69631, 74884, 79971, 85073, 90161]],
    ["HDDM-A",      [45550]],
    ["HDDM-W",      [45042, 55128, 62714, 69881, 81548, 88602]],
    ["RDDM",        [394, 5548, 12323, 17500, 22751, 45203, 64206, 70175, 75451, 80711, 88700, 94068]],
    ["ADWin",       [45407]],
    ["KSWin",       []],
    ["StepD",       [2891, 8771, 14772, 20019, 29840, 38629, 45079, 52859, 58177, 63481, 71355, 77337, 82959, 88444]],
]

Abrupt_HP_20_5 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [70000]],
    ["LAPScore",    [5000, 15000, 25000, 35000, 45000, 80000, 90000]],
    ["CUMSUM",      [45242, 57565, 68321, 77564, 92276]],
    ["Page-Hinkley",[45540, 57651, 68822, 91053]],
    ["DDM",         [505, 5549, 49332, 60218, 68944, 75425, 86123, 92005]],
    ["EDDM",        [310, 5549, 10994, 16216, 21437, 26593, 31818, 37896, 43245, 48412, 53630, 61565, 66801, 71954, 77152, 82480, 87750, 92928]],
    ["HDDM-A",      [45190, 61179, 80222]],
    ["HDDM-W",      [45190, 62723, 72550]],
    ["RDDM",        [394, 5548, 12323, 17500, 22751, 45352, 53559, 58929, 64108, 69544, 74756, 79923, 85359, 94408]],
    ["ADWin",       [45631, 64966]],
    ["KSWin",       []],
    ["StepD",       [2891, 8771, 14772, 20019, 29840, 38629, 45189, 52734, 58663, 66496, 71926, 77149, 85019, 91986]],
]

Abrupt_HP_20_20 = [
    ["REFERENCE",   [45000]],
    ["LASSO",       [45000]],
    ["LAPScore",    [5000, 15000, 25000, 35000, 45000, 80000, 90000]],
    ["CUMSUM",      [45194, 57548, 71948, 87381]],
    ["Page-Hinkley",[45378, 57668, 71528, 91612]],
    ["DDM",         [505, 5549, 48011, 66597]],
    ["EDDM",        [310, 5549, 10994, 16216, 21437, 26593, 31818, 37896, 43245, 48324, 53437, 58657, 63756, 69309, 74420, 79541, 84908]],
    ["HDDM-A",      [45142, 56516, 80028]],
    ["HDDM-W",      [45190, 54199, 61566, 69002, 77136, 82969, 90678]],
    ["RDDM",        [394, 5548, 12323, 17500, 22751, 45252, 56508, 75492, 80691, 86188, 94725]],
    ["ADWin",       [45439, 67462]],
    ["KSWin",       []],
    ["StepD",       [2891, 8771, 14772, 20019, 29840, 38629, 45024, 50545, 56160, 61943, 68242, 77495, 84746, 90672]],
]

abrupt_balanced_52848 = [
    ["REFERENCE",   [11710, 16858, 30598, 36040, 36868]],
    ["LASSO",       [13215, 18501, 29073]],
    ["LAPScore",    [2643]],
    ["CUMSUM",      [10023, 15288, 25358, 30628, 35633, 44223, 49434]],
    ["Page-Hinkley",[10140, 15391, 25453, 30665, 35587, 44282, 49470]],
    ["DDM",         [10070, 15980, 25480, 31257, 35850, 38538, 44207, 49405]],
    ["EDDM",        [491, 3249, 6075, 8895, 11733, 14460, 17172, 20058, 25441, 28430, 31131, 33900, 36615, 39386, 42248, 44981, 48118]],
    ["HDDM-A",      [6742, 9973, 15279, 21021, 25311, 30601, 33443, 44177, 49400]],
    ["HDDM-W",      [8412, 11718, 15222, 19485, 25304, 30539, 35128, 44140, 49392]],
    ["RDDM",        [10025, 13402, 16893, 20411, 24547, 27663, 30528, 35589, 41325, 44139, 47061]],
    ["ADWin",       [10111, 15505, 25507, 30709, 35783, 44313, 49451]],
    ["KSWin",       [9980, 16815, 25327]],
    ["StepD",       [4050, 6753, 9968, 13217, 16242, 19486, 25306, 30542, 33339, 36052, 40717, 44042, 49389]],
]

abrupt_imbalanced_355275 = [
    ["REFERENCE",   [66095, 110887, 164556, 225119, 250616]],
    ["LASSO",       [88820, 319752]],
    ["LAPScore",    []],
    ["CUMSUM",      [18652, 66148, 105218, 143862, 164780, 193430, 225195, 244232, 283943, 317422]],
    ["Page-Hinkley",[19081, 66235, 105580, 149570, 193389, 225358, 252795, 318958]],
    ["DDM",         [1223, 19089, 66378, 105546, 157315, 175140, 193422, 225287, 243410, 261550, 332917]],
    ["EDDM",        [167, 18045, 35933, 53858, 71691, 89825, 107661, 125588, 143543, 161556, 179651, 197521, 215403, 233311, 251176, 269152, 320207]],
    ["HDDM-A",      [16843, 52498, 72922, 105391, 140264, 164708, 193412, 225133, 243449, 261547, 279567, 317338]],
    ["HDDM-W",      [18580, 52499, 71842, 105145, 123895, 165104, 192106, 212094, 232183, 250649, 317406]],
    ["RDDM",        [769, 21578, 43204, 63209, 82796, 105470, 123459, 157362, 193918, 212105, 230153, 250656, 285005, 303373, 324977]],
    ["ADWin",       [19359, 66466, 105669, 153512, 194155, 225486, 249585, 319828]],
    ["KSWin",       [66116]],
    ["StepD",       [780, 18711, 36605, 55535, 75612, 96294, 119358, 137324, 155619, 178822, 198325, 216389, 238395, 258149, 278863, 307434, 331468]],
]

gradual_balanced_24150 = [
    ["REFERENCE",   [12821]],
    ["LASSO",       [3624, 12080, 13288, 22952]],
    ["LAPScore",    [1208, 3624, 4832, 6040]],
    ["CUMSUM",      [2118, 9407, 12652, 21640]],
    ["Page-Hinkley",[2133, 9470, 12707, 21793]],
    ["DDM",         [213, 2062, 10546, 12592]],
    ["EDDM",        [404, 2043, 3700, 5093, 6489, 8074, 9351, 10660, 12621, 13905, 15185, 16992, 18304, 19610, 20912, 22424]],
    ["HDDM-A",      [2041, 9354, 12638, 21519]],
    ["HDDM-W",      [2060, 9269, 12617, 14898, 19510, 21063]],
    ["RDDM",        [151, 1538, 2978, 4535, 8195, 9678, 11070, 12592, 17319, 18906, 21560, 22921]],
    ["ADWin",       [2143, 9622, 12653, 21988]],
    ["KSWin",       [2063, 10583, 12608, 21535]],
    ["StepD",       [213, 2041, 3661, 9093, 10589, 11856, 16001, 17494, 21536]],
]

gradual_imbalanced_143323 = [
    ["REFERENCE",   [50993]],
    ["LASSO",       [57336]],
    ["LAPScore",    []],
    ["CUMSUM",      [9973, 32746, 48206, 78197, 88863, 122336]],
    ["Page-Hinkley",[11099, 34387, 48479, 78327, 88953, 123278]],
    ["DDM",         [10428, 49734, 78348, 88906, 124260]],
    ["EDDM",        [809, 8223, 15551, 22830, 30223, 37639, 45128, 52423, 59803, 67178, 74609, 83095, 90337, 97731, 105071, 112424, 119793, 127098, 134373]],
    ["HDDM-A",      [577, 9411, 16672, 32751, 48437, 78229, 88779, 122742]],
    ["HDDM-W",      [10007, 35995, 48103, 78131, 87217, 122187, 133284]],
    ["RDDM",        [9900, 17591, 25029, 32813, 40158, 47788, 55597, 63230, 70543, 78134, 88806, 96138, 103921, 122230, 133652]],
    ["ADWin",       [13439, 36797, 48571, 78521, 88951, 124725]],
    ["KSWin",       []],
    ["StepD",       [1382, 9236, 17563, 25415, 33736, 42258, 49598, 60405, 68521, 77132, 85044, 93552, 107166, 116333, 123714, 131017]],
]

incremental_reoccurring_balanced_79986 = [
    ["REFERENCE",   [22569, 49365]],
    ["LASSO",       [4000, 20000, 32000, 40000, 52000]],
    ["LAPScore",    []],
    ["CUMSUM",      [3882, 11218, 17072, 22614, 29863, 36496, 44204, 49061, 58408, 64594, 70483]],
    ["Page-Hinkley",[4174, 11240, 17285, 22622, 30297, 36883, 44403, 49095, 58412, 64733, 70567]],
    ["DDM",         [4038, 11238, 19330, 44393, 48533, 53263, 68525, 72594]],
    ["EDDM",        [4031, 8130, 17083, 22587, 27266, 31436, 35554, 39732, 44138, 48874, 53006, 57074, 61202, 65271, 69387, 74925]],
    ["HDDM-A",      [348, 14482, 20759, 25380, 29850, 36455, 44091, 48918, 53179, 68062, 74485]],
    ["HDDM-W",      [1615, 6766, 11114, 16458, 22581, 29741, 36077, 40440, 48257, 53132, 57822, 64469, 70227]],
    ["RDDM",        [3823, 10184, 14396, 18613, 24738, 29615, 36135, 40426, 45015, 49315, 57181, 64526, 70417, 75153]],
    ["ADWin",       [4287, 11358, 17277, 22620, 30715, 36538, 44377, 49144, 59607, 64694, 70613]],
    ["KSWin",       [49386]],
    ["StepD",       [1497, 7615, 13985, 19360, 25122, 29514, 34704, 39428, 44088, 48555, 53128, 57646, 64462, 69179, 74126]],
]

incremental_reoccurring_imbalanced_452044 = [
    ["REFERENCE",   [128081, 278763]],
    ["LASSO",       []],
    ["LAPScore",    []],
    ["CUMSUM",      [7171, 31263, 57683, 95375, 136213, 180031, 214602, 239330, 271131, 297637, 325955, 358362, 396671]],
    ["Page-Hinkley",[12048, 61022, 95963, 141211, 180719, 215454, 239486, 271260, 298071, 333329, 359562, 397240]],
    ["DDM",         [12200, 59285, 98348, 137646, 243669, 271378, 294025, 319644, 359491, 397133]],
    ["EDDM",        [14831, 37527, 60385, 83190, 198779, 221557, 244290, 267091, 299467, 322220, 345041, 367760, 390553, 413373]],
    ["HDDM-A",      [10832, 45819, 79681, 141722, 180031, 214598, 239196, 271127, 297294, 332877, 358500, 396592]],
    ["HDDM-W",      [29, 30942, 57688, 83393, 115637, 151769, 179859, 207468, 239213, 267243, 291866, 314993, 344404, 370902, 396420]],
    ["RDDM",        [7168, 29920, 52702, 100003, 134467, 180519, 203293, 239663, 271235, 294031, 318993, 341887, 364645, 396819]],
    ["ADWin",       [11775, 50825, 97619, 140701, 181031, 216497, 246811, 271333, 298063, 334681, 360963, 397965]],
    ["KSWin",       [231034, 256811, 279694, 314364]],
    ["StepD",       [872, 24470, 49751, 75441, 98605, 123476, 146296, 169392, 193935, 216629, 239502, 264685, 288803, 311974, 334922, 358236, 383604, 407238]],
]

empty = [
    ["REFERENCE",   []],
    ["LASSO",       []],
    ["LAPScore",    []],
    ["CUMSUM",      []],
    ["Page-Hinkley",[]],
    ["DDM",         []],
    ["EDDM",        []],
    ["HDDM-A",      []],
    ["HDDM-W",      []],
    ["RDDM",        []],
    ["ADWin",       []],
    ["KSWin",       []],
    ["StepD",       []],
]

dname = "Recurring_HP_1_5"      # Title
detectors = Recurring_HP_1_5    # Structure name; structure has drift points relative to test set begin!!!
realDriftIdx = detectors[0][1]  # Reference drifts position
scount = 100000                 # Sample count (TOTAL!!!)
epsilon = 2000                  # Detection tolerance (absolute)
offset = int(scount * 0.05)     # Detection offsets (initial training set size)
ystep = 0.125

plt.figure(figsize=(8, 8))
plt.xlim(0, scount)

y1 = []
y2 = []
labels = []
legends = []

for det in range(0, len(detectors)):
    detectedTrueDriftIdx, detectedFalseDriftIdx = split_detections(
        detectors[det][1], realDriftIdx, epsilon
    )

    opos = ystep * det

    horizLine.append([opos] * scount)

    odetTDidx = [x + offset for x in detectedTrueDriftIdx]
    odetFDidx = [x + offset for x in detectedFalseDriftIdx]
    oRealIdx = [x + offset for x in realDriftIdx]

    # Plot drift detection points
    for oReal in oRealIdx:
        plt.axvspan(
            xmin=oReal - epsilon,
            xmax=oReal + epsilon,
            ymin=0.05,
            ymax=0.95,
            facecolor="lightgrey",
        )
    plt.eventplot(
        odetTDidx,
        orientation="horizontal",
        lineoffsets=opos,
        linelengths=0.1,
        linewidths=3,
        colors="green",
        linestyles="-",
        label="True Positive" if det == 0 else "_",
    )
    plt.eventplot(
        odetFDidx,
        orientation="horizontal",
        lineoffsets=opos,
        linelengths=0.1,
        linewidths=3,
        colors="red",
        linestyles="-",
        label="False Positive" if det == 0 else "_",
    )
    plt.plot(horizLine[det], "black")
    plt.xlabel("Instances")
    y1.extend([opos])
    labels.extend([detectors[det][0]])
    y2.extend([opos - 0.05, opos + 0.05])
    legends.extend(["Detected", "Reference"])
plt.yticks(y1, labels)
start, end = plt.gca().get_xlim()
plt.gca().xaxis.set_ticks(np.arange(start, end + 1, 25000))
plt.title(dname)
plt.legend(loc="lower right")
plt.show()
